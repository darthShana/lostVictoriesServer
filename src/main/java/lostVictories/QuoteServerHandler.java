package lostVictories;

import io.netty.buffer.Unpooled;
import io.netty.channel.ChannelHandlerContext;
import io.netty.channel.SimpleChannelInboundHandler;
import io.netty.channel.socket.DatagramPacket;
import io.netty.util.CharsetUtil;
import org.apache.commons.lang.RandomStringUtils;

import java.util.Random;

public class QuoteServerHandler extends SimpleChannelInboundHandler<DatagramPacket> {
    
    private static String nextQuote() {

        return "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";
    }


    @Override
    public void messageReceived(ChannelHandlerContext ctx, DatagramPacket packet) {       
        System.err.println(packet.content().toString(CharsetUtil.UTF_8));
        if ("Quote".equals(packet.content().toString(CharsetUtil.UTF_8))) {
            ctx.write(new DatagramPacket(Unpooled.copiedBuffer(nextQuote(), CharsetUtil.UTF_8), packet.sender()));
        
        }
    }

    @Override
    public void channelReadComplete(ChannelHandlerContext ctx) {
        ctx.flush();
    }
}